<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example model uncertainty and sensitivity â€¢ Rcentury</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example model uncertainty and sensitivity">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Rcentury</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Example_uncertainty_sensitivity.html">Example model uncertainty and sensitivity</a></li>
    <li><a class="dropdown-item" href="../articles/How-to-run-century.html">How to run CENTURY 4.7</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example model uncertainty and sensitivity</h1>
            
      

      <div class="d-none name"><code>Example_uncertainty_sensitivity.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>We can use the Rcentury package to assess how uncertainties (aka
errors) in a modelâ€™s parameters contribute to the overall uncertainty of
its output. In general, for many models it is possible to derive
approximate analytical expressions for n-error error propagation by
using Taylor expansions, which involves calculating analytical n-order
derivatives. However, this approach quickly becomes cumbersome and
impractical when the number of parameters grows high and, especially,
when the function to evaluate is very complex and non-linear like
CENTURY. Therefore, to determine error propagation for the CENTURY model
we turn to a much simpler Monte Carlo numerical approach, which consists
of feeding the model with input parameters of interests which vary
randomly at each model run following a given distribution of known mean
and variance.</p>
<p>For the sake of simplicity we will demonstrate how to perform an
uncertainty propagation analysis of uncertainty in soil texture
(i.e.Â clay, silt and sand) only, keeping all the other parameters of the
model fixed. In this case, at each model run we will draw random
proportion values for each of the three parameters, calculate the
CENTURY model with those values and then save the output. This will be
done many times to derive reliable confidence intervals for the
output.</p>
<p>Texture is always given as a set of 3 proportions which add up to 1
always, we need to specify a random distribution that accounts for that
property. Consequently, we turn to Dirichlet distributions, which allow
us to model probability distributions of outcomes for categorical
events, such that the total probability adds up to one. For details, see
Annex below.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="rcentury-simulations">Rcentury simulations<a class="anchor" aria-label="anchor" href="#rcentury-simulations"></a>
</h3>
<p>For this example we will use the forest data from CENTURY example
files. We will create a temporary directory and move there all necessary
files (ASCII data files and executables). The simulation will be carried
out with the so-called
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="monospace">ğšğšğš”ğš.ğŸ·ğŸ¶ğŸ¶</mtext><annotation encoding="application/x-tex">\texttt{duke.100}</annotation></semantics></math>
example, though any other site would do.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">from_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/4.forest"</span>,  package <span class="op">=</span> <span class="st">"Rcentury"</span><span class="op">)</span></span>
<span><span class="va">to_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="va">from_dir</span>, <span class="va">to_dir</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">path_exe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"bin/windows"</span>,  package <span class="op">=</span> <span class="st">"Rcentury"</span><span class="op">)</span></span>
<span><span class="va">century_exe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path_exe</span>, <span class="st">"century_47.exe"</span><span class="op">)</span></span>
<span><span class="va">list100_exe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path_exe</span>, <span class="st">"list100_47.exe"</span><span class="op">)</span></span>
<span><span class="va">to_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">to_dir</span>, <span class="st">"4.forest"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="va">century_exe</span>, <span class="va">to_dir</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="va">list100_exe</span>, <span class="va">to_dir</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>Below we will need package
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="monospace">ğšğš¡ğšğš›ğšŠğ™³ğš’ğšœğšğš›</mtext><annotation encoding="application/x-tex">\texttt{extraDistr}</annotation></semantics></math>,
available from CRAN, which will provide us with a random-number
generator for the Dirichlet distribution. We will also load the Rcentury
package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("extraDistr")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/twolodzko/extraDistr" class="external-link">extraDistr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'extraDistr' was built under R version 4.4.3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Rcentury</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>We intend to model the propagation of uncertainty for, and
sensibility to, texture parameters. Those parameters are included in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="monospace">ğšğšğš”ğš.ğŸ·ğŸ¶ğŸ¶</mtext><annotation encoding="application/x-tex">\texttt{duke.100}</annotation></semantics></math>
site file, which is then read by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="monospace">ğšŒğšğš—ğšğšğš›ğš¢_ğŸºğŸ½.ğšğš¡ğš</mtext><annotation encoding="application/x-tex">\texttt{century_47.exe}</annotation></semantics></math>
during execution. Consequently, we use package functions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="monospace">ğš›ğšğšŠğš_ğšœğš’ğšğš.ğš</mtext><annotation encoding="application/x-tex">\texttt{read_site.R}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="monospace">ğš ğš›ğš’ğšğš_ğšœğš’ğšğš.ğš</mtext><annotation encoding="application/x-tex">\texttt{write_site.R}</annotation></semantics></math>
to read site data and write it back onto disk at each simulation
step.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#</span></span>
<span><span class="va">site</span> <span class="op">&lt;-</span> <span class="va">site2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_site.html">read_site</a></span><span class="op">(</span><span class="va">to_dir</span>, <span class="st">"duke.100"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">site</span><span class="op">$</span><span class="va">`site and control`</span><span class="op">$</span><span class="va">df</span></span>
<span><span class="va">sand</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">field</span> <span class="op">==</span> <span class="st">"SAND"</span><span class="op">]</span></span>
<span><span class="va">silt</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">field</span> <span class="op">==</span> <span class="st">"SILT"</span><span class="op">]</span></span>
<span><span class="va">clay</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">field</span> <span class="op">==</span> <span class="st">"CLAY"</span><span class="op">]</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dirichlet_params.html">dirichlet_params</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sand</span>, <span class="va">silt</span>, <span class="va">clay</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">.01</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nsimu</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsimu</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Random Dirichlet triplet.</span></span>
<span>  <span class="va">texture_random</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Dirichlet.html" class="external-link">rdirichlet</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Save &lt;site&gt;.100 file.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">site2</span><span class="op">$</span><span class="va">`site and control`</span><span class="op">$</span><span class="va">df</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">field</span> <span class="op">==</span> <span class="st">"SAND"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">texture_random</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">field</span> <span class="op">==</span> <span class="st">"SILT"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">texture_random</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">field</span> <span class="op">==</span> <span class="st">"CLAY"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">texture_random</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">site2</span><span class="op">$</span><span class="va">`site and control`</span><span class="op">$</span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>  <span class="fu"><a href="../reference/write_site.html">write_site</a></span><span class="op">(</span><span class="va">site2</span>, <span class="va">to_dir</span>, <span class="st">"duke.100"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">df</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/century_run.html">century_run</a></span><span class="op">(</span><span class="va">to_dir</span>, <span class="st">"duke.sch"</span>, <span class="st">"res.bin"</span>, <span class="st">"res.lis"</span>, <span class="st">"outvars.txt"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">to_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"res.bin"</span>, <span class="st">"res.lis"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="annex-how-to-draw-multivariate-proportions">Annex: How to draw multivariate proportions<a class="anchor" aria-label="anchor" href="#annex-how-to-draw-multivariate-proportions"></a>
</h2>
<p>The means of the proportions will be fixed in our simulations.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>x</mi><mi>K</mi></msub><mo>;</mo><msub><mi>Î±</mi><mn>1</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Î±</mi><mi>K</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›‚</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>x</mi><mi>i</mi><mrow><msub><mi>Î±</mi><mi>i</mi></msub><mo>âˆ’</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">f(x_1, \dots, x_K; \alpha_1, \dots, \alpha_K) = \frac{1}{B(\boldsymbol{\alpha})} \prod_{i=1}^K x_i^{\alpha_i - 1}</annotation></semantics></math></p>
<p>where:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›‚</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>Î“</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Î“</mi><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>Î±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">B(\boldsymbol{\alpha}) = \frac{\prod_{i=1}^K \Gamma(\alpha_i)}{\Gamma(\sum_{i=1}^K \alpha_i)}</annotation></semantics></math></p>
<p>and:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>âˆˆ</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for all </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>K</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">x_i \in [0, 1], \quad \text{for all } i \in \{1, \dots, K\}</annotation></semantics></math></p>
<p>as well as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^K x_i = 1</annotation></semantics></math></p>
<p>The mean of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
is, then:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><msub><mi>Î±</mi><mi>i</mi></msub><mrow><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>Î±</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">E[x_i] = \frac{\alpha_i}{\sum_{j=1}^K \alpha_j}</annotation></semantics></math>
and the expression for the variance is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mrow><mover><msub><mi>Î±</mi><mi>i</mi></msub><mo accent="true">Ìƒ</mo></mover><mo>â‹…</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mover><msub><mi>Î±</mi><mi>i</mi></msub><mo accent="true">Ìƒ</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>Î±</mi><mn>0</mn></msub><mo>âˆ’</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">Var[x_i] = \frac{\tilde{\alpha_i}\cdot(1-\tilde{\alpha_i})}{\alpha_0-1}</annotation></semantics></math></p>
<p>where:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msub><mi>Î±</mi><mi>i</mi></msub><mo accent="true">Ìƒ</mo></mover><mo>=</mo><mfrac><msub><mi>Î±</mi><mi>i</mi></msub><msub><mi>Î±</mi><mn>0</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">\tilde{\alpha_i}=\frac{\alpha_i}{\alpha_0}</annotation></semantics></math>
We can use those two expressions to calculate the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î±</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\alpha_j</annotation></semantics></math>
values when we are given four parameters for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[x_i]</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>V</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[V_i]</annotation></semantics></math>.
The Rcentury package provides with a function, called
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="monospace">ğšğš’ğš›ğš’ğšŒğš‘ğš•ğšğš_ğš™ğšŠğš›ğšŠğš–ğšœ.ğš</mtext><annotation encoding="application/x-tex">\texttt{dirichlet_params.R}</annotation></semantics></math>,
that can calculate the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î±</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\alpha_j</annotation></semantics></math>
values when all the means
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> for all </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>K</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">E[x_i]\text{ for all } i \in \{1, \dots, K\}</annotation></semantics></math>
and one single variance value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">Var[x_j]</annotation></semantics></math>
are known.</p>
<p>For example, for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">K=3</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>.35</mn></mrow><annotation encoding="application/x-tex">E[x_1]=.35</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>.12</mn></mrow><annotation encoding="application/x-tex">E[x_2]=.12</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>.53</mn></mrow><annotation encoding="application/x-tex">E[x_3]=.53</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>.17</mn></mrow><annotation encoding="application/x-tex">Var[x_2]=.17</annotation></semantics></math>,
we can easily generate sequences of Dirichlet-distributed triplets.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dirichlet_params.html">dirichlet_params</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.35</span>, <span class="fl">.12</span>, <span class="fl">.53</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">.042</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Dirichlet.html" class="external-link">rdirichlet</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"First component"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"Second component"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"Third component"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example_uncertainty_sensitivity_files/figure-html/hist_triplets-1.png" width="672"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
